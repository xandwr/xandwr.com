---
type Status = "ACTIVE" | "PAUSED" | "ARCHIVED";
interface ProjectCardProps {
    title: string;
    description: string;
    github?: string;
    website?: string;
    thumbnail?: string;
    status: Status;
}
const { title, description, github, website, thumbnail, status } =
    Astro.props as ProjectCardProps;
const statusClasses: Record<Status, string> = {
    ACTIVE: "border-green-500 shadow-[0_0_12px_2px_rgba(34,197,94,0.3)]",
    PAUSED: "border-orange-400 shadow-[0_0_12px_2px_rgba(251,146,60,0.3)]",
    ARCHIVED: "border-red-500 shadow-[0_0_12px_2px_rgba(239,68,68,0.3)]",
};
---

<div class="project-card group perspective-[1000px]">
    <div
        class={`tilt-card flex flex-col rounded-lg p-6 bg-white/5 hover:bg-white/10 group h-full transition-transform duration-150 ease-out will-change-transform border border-white/10 ${
            statusClasses[status] ?? ""
        }`}
    >
        {
            thumbnail && (
                <div class="relative rounded-lg mb-4 overflow-hidden">
                    <img
                        src={thumbnail}
                        alt={`Thumbnail for ${title}`}
                        class="object-cover w-full max-h-40"
                    />
                    <div class="absolute inset-0 rounded-lg pointer-events-none shadow-[inset_0_0_60px_rgba(255,255,255,0.1)]" />
                </div>
            )
        }

        <h2 class="text-2xl font-semibold mb-2 underline underline-offset-4">
            {title}
        </h2>
        {
            status && (
                <div
                    class={`mb-2 inline-block px-2 py-0.5 text-xs font-medium rounded ${
                        status === "ACTIVE"
                            ? "bg-green-500/10 text-green-300 border border-green-500/30"
                            : status === "PAUSED"
                              ? "bg-orange-400/10 text-orange-300 border border-orange-400/30"
                              : status === "ARCHIVED"
                                ? "bg-red-500/10 text-red-300 border border-red-500/30"
                                : ""
                    }`}
                >
                    {status}
                </div>
            )
        }

        <p class="text-base text-white/70 mb-4 flex-grow">{description}</p>

        <div class="mt-auto flex gap-4 pt-4 border-t border-white/10">
            {
                github && (
                    <a
                        href={github}
                        class="text-sm text-blue-400 group-hover:text-blue-300 transition"
                        target="_blank"
                        rel="noopener noreferrer"
                    >
                        GitHub →
                    </a>
                )
            }
            {
                website && (
                    <a
                        href={website}
                        class="text-sm text-green-400 group-hover:text-green-300 transition"
                        target="_blank"
                        rel="noopener noreferrer"
                    >
                        Website →
                    </a>
                )
            }
        </div>
    </div>
</div>

<script>
    if (typeof window !== "undefined") {
        document
            .querySelectorAll<HTMLElement>(".project-card")
            .forEach((card) => {
                const tilt = card.querySelector<HTMLElement>(".tilt-card");
                if (!tilt) return;

                card.addEventListener("mousemove", (e: MouseEvent) => {
                    const rect = card.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;

                    const rotateY = (x / rect.width - 0.5) * 10;
                    const rotateX = (y / rect.height - 0.5) * -10;

                    tilt.style.transform = `rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
                });

                card.addEventListener("mouseleave", () => {
                    tilt.style.transform = "rotateX(0deg) rotateY(0deg)";
                });
            });
    }
</script>
